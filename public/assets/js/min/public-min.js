(function(){function t(){}function e(t,e){for(var n=t.length;n--;)if(t[n].listener===e)return n;return-1}function n(t){return function(){return this[t].apply(this,arguments)}}var i=t.prototype,o=this,r=o.EventEmitter;i.getListeners=function(t){var e,n,i=this._getEvents();if("object"==typeof t)for(n in e={},i)i.hasOwnProperty(n)&&t.test(n)&&(e[n]=i[n]);else e=i[t]||(i[t]=[]);return e},i.flattenListeners=function(t){var e,n=[];for(e=0;t.length>e;e+=1)n.push(t[e].listener);return n},i.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&((e={})[t]=n),e||n},i.addListener=function(t,n){var i,o=this.getListenersAsObject(t),r="object"==typeof n;for(i in o)o.hasOwnProperty(i)&&-1===e(o[i],n)&&o[i].push(r?n:{listener:n,once:!1});return this},i.on=n("addListener"),i.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},i.once=n("addOnceListener"),i.defineEvent=function(t){return this.getListeners(t),this},i.defineEvents=function(t){for(var e=0;t.length>e;e+=1)this.defineEvent(t[e]);return this},i.removeListener=function(t,n){var i,o,r=this.getListenersAsObject(t);for(o in r)r.hasOwnProperty(o)&&(-1!==(i=e(r[o],n))&&r[o].splice(i,1));return this},i.off=n("removeListener"),i.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},i.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},i.manipulateListeners=function(t,e,n){var i,o,r=t?this.removeListener:this.addListener,s=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(i=n.length;i--;)r.call(this,e,n[i]);else for(i in e)e.hasOwnProperty(i)&&(o=e[i])&&("function"==typeof o?r.call(this,i,o):s.call(this,i,o));return this},i.removeEvent=function(t){var e,n=typeof t,i=this._getEvents();if("string"===n)delete i[t];else if("object"===n)for(e in i)i.hasOwnProperty(e)&&t.test(e)&&delete i[e];else delete this._events;return this},i.removeAllListeners=n("removeEvent"),i.emitEvent=function(t,e){var n,i,o,r=this.getListenersAsObject(t);for(o in r)if(r.hasOwnProperty(o))for(i=r[o].length;i--;)!0===(n=r[o][i]).once&&this.removeListener(t,n.listener),n.listener.apply(this,e||[])===this._getOnceReturnValue()&&this.removeListener(t,n.listener);return this},i.trigger=n("emitEvent"),i.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},i.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},i._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},i._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return o.EventEmitter=r,t},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:this.EventEmitter=t}).call(this),function(t){function e(e){var n=t.event;return n.target=n.target||n.srcElement||e,n}var n=document.documentElement,i=function(){};n.addEventListener?i=function(t,e,n){t.addEventListener(e,n,!1)}:n.attachEvent&&(i=function(t,n,i){t[n+i]=i.handleEvent?function(){var n=e(t);i.handleEvent.call(i,n)}:function(){var n=e(t);i.call(t,n)},t.attachEvent("on"+n,t[n+i])});var o=function(){};n.removeEventListener?o=function(t,e,n){t.removeEventListener(e,n,!1)}:n.detachEvent&&(o=function(t,e,n){t.detachEvent("on"+e,t[e+n]);try{delete t[e+n]}catch(i){t[e+n]=void 0}});var r={bind:i,unbind:o};"function"==typeof define&&define.amd?define("eventie/eventie",r):t.eventie=r}(this),function(t,e){"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(n,i){return e(t,n,i)}):"object"==typeof exports?module.exports=e(t,require("wolfy87-eventemitter"),require("eventie")):t.imagesLoaded=e(t,t.EventEmitter,t.eventie)}(window,function(t,e,n){function i(t,e){for(var n in e)t[n]=e[n];return t}function o(t){var e,n=[];if(e=t,"[object Array]"===d.call(e))n=t;else if("number"==typeof t.length)for(var i=0,o=t.length;o>i;i++)n.push(t[i]);else n.push(t);return n}function r(t,e,n){if(!(this instanceof r))return new r(t,e);"string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=o(t),this.options=i({},this.options),"function"==typeof e?n=e:i(this.options,e),n&&this.on("always",n),this.getImages(),u&&(this.jqDeferred=new u.Deferred);var s=this;setTimeout(function(){s.check()})}function s(t){this.img=t}function a(t){this.src=t,p[t]=this}var u=t.jQuery,f=t.console,c=void 0!==f,d=Object.prototype.toString;r.prototype=new e,r.prototype.options={},r.prototype.getImages=function(){this.images=[];for(var t=0,e=this.elements.length;e>t;t++){var n=this.elements[t];"IMG"===n.nodeName&&this.addImage(n);var i=n.nodeType;if(i&&(1===i||9===i||11===i))for(var o=n.querySelectorAll("img"),r=0,s=o.length;s>r;r++){var a=o[r];this.addImage(a)}}},r.prototype.addImage=function(t){var e=new s(t);this.images.push(e)},r.prototype.check=function(){function t(t,o){return e.options.debug&&c&&f.log("confirm",t,o),e.progress(t),++n===i&&e.complete(),!0}var e=this,n=0,i=this.images.length;if(this.hasAnyBroken=!1,i)for(var o=0;i>o;o++){var r=this.images[o];r.on("confirm",t),r.check()}else this.complete()},r.prototype.progress=function(t){this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded;var e=this;setTimeout(function(){e.emit("progress",e,t),e.jqDeferred&&e.jqDeferred.notify&&e.jqDeferred.notify(e,t)})},r.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var e=this;setTimeout(function(){if(e.emit(t,e),e.emit("always",e),e.jqDeferred){var n=e.hasAnyBroken?"reject":"resolve";e.jqDeferred[n](e)}})},u&&(u.fn.imagesLoaded=function(t,e){return new r(this,t,e).jqDeferred.promise(u(this))}),s.prototype=new e,s.prototype.check=function(){var t=p[this.img.src]||new a(this.img.src);if(t.isConfirmed)this.confirm(t.isLoaded,"cached was confirmed");else if(this.img.complete&&void 0!==this.img.naturalWidth)this.confirm(0!==this.img.naturalWidth,"naturalWidth");else{var e=this;t.on("confirm",function(t,n){return e.confirm(t.isLoaded,n),!0}),t.check()}},s.prototype.confirm=function(t,e){this.isLoaded=t,this.emit("confirm",this,e)};var p={};return a.prototype=new e,a.prototype.check=function(){if(!this.isChecked){var t=new Image;n.bind(t,"load",this),n.bind(t,"error",this),t.src=this.src,this.isChecked=!0}},a.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},a.prototype.onload=function(t){this.confirm(!0,"onload"),this.unbindProxyEvents(t)},a.prototype.onerror=function(t){this.confirm(!1,"onerror"),this.unbindProxyEvents(t)},a.prototype.confirm=function(t,e){this.isConfirmed=!0,this.isLoaded=t,this.emit("confirm",this,e)},a.prototype.unbindProxyEvents=function(t){n.unbind(t.target,"load",this),n.unbind(t.target,"error",this)},r}),function(t){"use strict";var e=function(){var e=t(window).height(),i=spuvar.is_admin,o=spuvar.is_preview,r=[];function s(e){var n=r[e],i=t(window).width(),o=t(window).height(),s=n.outerHeight(),a=n.outerWidth(),u=n.data("width"),f=0,c=o/2-s/2,d="fixed",p=t(document).scrollTop();n.hasClass("spu-centered")&&(u<i&&(f=i/2-a/2),n.css({left:f,position:d,top:c})),s+50>o&&(d="absolute",c=p,n.css({position:d,top:c,bottom:"auto"}))}function a(e){var n=e,i=n.data("total");if(i){!function(){if("undefined"!=typeof spuvar_social&&spuvar_social.facebook)try{FB.XFBML.parse()}catch(t){}if("undefined"!=typeof spuvar_social&&spuvar_social.google)try{gapi.plusone.go()}catch(t){}if("undefined"!=typeof spuvar_social&&spuvar_social.twitter)try{twttr.widgets.load()}catch(t){}}();var o=0,r=0,s=n.outerWidth(),a=n.find(".spu-content").width();!spuvar.disable_style&&t(window).width()>s&&(n.find(".spu-shortcode").wrapAll('<div class="spu_shortcodes"/>'),n.find(".spu-shortcode").each(function(){o+=t(this).outerWidth()}),r=a-o-20*i),r>0&&(n.find(".spu-shortcode").each(function(){t(this).css("margin-left",r/2)}),2==i?n.find(".spu-shortcode").last().css("margin-left",0):3==i&&n.find(".spu-shortcode").first().css("margin-left",0))}}function u(e,n,i){var o=r[e],u=t("#spu-bg-"+e),f=o.data("bgopa");if(o.is(":animated"))return!1;if(!0===n&&o.is(":visible")||!1===n&&o.is(":hidden"))return!1;if(!1===n){var c=parseFloat(o.data("close-cookie"));!0===i&&(c=parseFloat(o.data("cookie"))),c>0&&function(t,e,n){if(n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var o="; expires="+i.toGMTString()}else var o="";document.cookie=t+"="+e+o+"; path=/"}("spu_box_"+e,!0,c),o.trigger("spu.box_close",[e]);var d=o.find('iframe[src*="vimeo"],iframe[src*="youtube"]');d&&d.length&&o.remove()}else setTimeout(function(){a(o)},1500),o.trigger("spu.box_open",[e]),t(window).resize(function(){s(e)}),s(e);var p=o.data("spuanimation"),l=o.data("close-on-conversion");return"fade"===p?!0===n?o.fadeIn("slow"):!1===n&&(l&&i||!i)&&o.fadeOut("slow"):"disable"===p?!0===n?o.show():!1===n&&(l&&i||!i)&&o.hide():!0===n?o.slideDown("slow"):!1===n&&(l&&i||!i)&&o.slideUp("slow"),!0===n&&f>0?"disable"===p?u.show():u.fadeIn():!1===n&&(l&&i||!i)&&("disable"===p?u.hide():u.fadeOut()),n}return t(".spu-content").children().first().css({"margin-top":0,"padding-top":0}).end().last().css({"margin-bottom":0,"padding-bottom":0}),t(".spu-box").each(function(){spuvar.safe_mode&&t(this).prependTo("body");var s=t(this),a=s.data("trigger"),f=0,c=1===parseInt(s.data("test-mode")),d=s.data("box-id"),p=1===parseInt(s.data("auto-hide")),l=(parseInt(s.data("seconds-close")),parseInt(s.data("trigger-number"),10)),h=("percentage"==a?parseInt(s.data("trigger-number"),10)/100:.8)*t(document).height();!function(e){var n=t(e).find(".spu-facebook");if(n.length){var i=n.find(".fb-like > span").width();if(0==i){var o=n.find(".fb-like").data("layout");"box_count"==o?n.append('<style type="text/css"> #'+t(e).attr("id")+" .fb-like iframe, #"+t(e).attr("id")+" .fb_iframe_widget span, #"+t(e).attr("id")+" .fb_iframe_widget{ height: 63px !important;width: 80px !important;}</style>"):"button_count"==o?n.append('<style type="text/css"> #'+t(e).attr("id")+" .fb-like iframe, #"+t(e).attr("id")+" .fb_iframe_widget span, #"+t(e).attr("id")+" .fb_iframe_widget{ height: 20px !important;min-width: 120px !important;}</style>"):n.append('<style type="text/css"> #'+t(e).attr("id")+" .fb-like iframe, #"+t(e).attr("id")+" .fb_iframe_widget span, #"+t(e).attr("id")+" .fb_iframe_widget{ height: 20px !important;width: 80px !important;}</style>")}}}(s),s.on("click",'a:not(".spu-close-popup, .flp_wrapper a, .spu-not-close, .spu-not-close a")',function(){u(d,!1,!0)}),t(document).keyup(function(t){27==t.keyCode&&u(d,!1,!1)});var m=navigator.userAgent,v=m.match(/iPad/i)||m.match(/iPhone/i)?"touchstart":"click";t("body").on(v,function(e){var n=t(e.target);void 0===e.originalEvent||t.contains(s,n)&&n.is("input")||u(d,!1,!1)}),t("body").on(v,".spu-box,.spu-clickable",function(t){t.stopPropagation()}),s.hide().css("left",""),r[d]=s;var g=function(){f&&clearTimeout(f),f=window.setTimeout(function(){t(window).scrollTop()+e>=h?(p||t(window).unbind("scroll",g),u(d,!0,!1)):u(d,!1,!1)},100)},w=function(){f&&clearTimeout(f),f=window.setTimeout(function(){t(window).scrollTop()>=l?(p||t(window).unbind("scroll",w),u(d,!0,!1)):u(d,!1,!1)},100)},b=function(t){for(var e=t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return null}("spu_box_"+d);(null==b||""==b||i&&c||o)&&("seconds"==a&&(f&&clearTimeout(f),f=window.setTimeout(function(){u(d,!0,!1)},1e3*l)),"percentage"==a&&(t(window).bind("scroll",g),g()),"pixels"==a&&(t(window).bind("scroll",w),w()),window.location.hash&&window.location.hash.length>0&&window.location.hash.substring(1)===s.attr("id")&&setTimeout(function(){u(d,!0,!1)},100));s.on("click",".spu-close-popup",function(){u(d,!1,!1),"percentage"==a&&t(window).unbind("scroll",g)}),t(document.body).on("click",'a[href="#spu-'+d+'"], .spu-open-'+d,function(t){t.preventDefault(),u(d,!0,!1)}),t('a[href="#spu-'+d+'"], .spu-open-'+d).css("cursor","pointer").addClass("spu-clickable"),s.find(".gform_wrapper form").addClass("gravity-form"),s.find(".mc4wp-form form").addClass("mc4wp-form"),s.find(".newsletter form").addClass("newsletter-form");var y=s.find("form");if(y.length){if(!y.is(".newsletter-form, .wpcf7-form, .gravity-form, .infusion-form, .widget_wysija, .ninja-forms-form")){var _=y.attr("action"),x=new RegExp(spuvar.site_url,"i");_&&_.length&&(x.test(_)||y.addClass("spu-disable-ajax"))}t(".spu-disable-ajax form").length&&t(".spu-disable-ajax form").addClass("spu-disable-ajax"),s.on("submit",'form.spu-disable-ajax:not(".flp_form")',function(){s.trigger("spu.form_submitted",[d]),u(d,!1,!0)}),s.on("submit",'form:not(".newsletter-form, .wpcf7-form, .gravity-form, .infusion-form, .spu-disable-ajax, .widget_wysija, .ninja-forms-form, .flp_form")',function(e){e.preventDefault();var i=t(this);return n(i.serialize(),i.hasClass("mc4wp-form")?spuvar.site_url+"/":i.attr("action"),function(e){var n=t(e).filter("#spu-"+d).html();t("#spu-"+d).html(n),t("#spu-"+d).find(".mc4wp-alert").length||setTimeout(function(){u(d,!1,!0)},1e3*spuvar.seconds_confirmation_close)},function(t,e,n){console.log("Spu Form error: "+e+" - "+n)},"html"),s.trigger("spu.form_submitted",[d]),!0}),t(document).on("wpcf7mailsent",function(){s.trigger("spu.form_submitted",[d]),u(d,!1,!0)}),y.hasClass("gravity-form")&&y.attr("action",window.location.href),t(document).on("gform_confirmation_loaded",function(){s.trigger("spu.form_submitted",[d]),u(d,!1,!0)}),s.on("submit",".infusion-form",function(t){t.preventDefault(),s.trigger("spu.form_submitted",[d]),u(d,!1,!0),this.submit()}),s.on("submit",".newsletter-form",function(t){t.preventDefault(),s.trigger("spu.form_submitted",[d]),u(d,!1,!0),this.submit()}),t("body").on("submitResponse.default",function(){s.trigger("spu.form_submitted",[d]),u(d,!1,!0)})}s.find(".nf-form-cont").length&&t(document).on("nfFormSubmitResponse",function(){s.trigger("spu.form_submitted",[d]),setTimeout(function(){u(d,!1,!0)},1e3*spuvar.seconds_confirmation_close)})}),{show:function(t){return u(t,!0,!1)},hide:function(t,e,n){return u(t,!1,n)},request:function(t,e,i,o){return n(t,e,i,o)}}};if(spuvar.ajax_mode){n({pid:spuvar.pid,referrer:document.referrer,query_string:document.location.search,is_category:spuvar.is_category,is_archive:spuvar.is_archive,is_preview:spuvar.is_preview},spuvar.ajax_mode_url,function(n){t("body").append(n),t(".spu-box").imagesLoaded(function(){window.SPU=e(),t(".spu-box form").each(function(){var e=t(this).attr("action");e&&t(this).attr("action",e.replace("?spu_action=spu_load",""))}),t.fn.wpcf7InitForm&&t(".spu-box div.wpcf7 > form").wpcf7InitForm()})},function(t,e,n){console.log("Problem loading popups - error: "+e+" - "+n)},"html")}else t(".spu-box").imagesLoaded(function(){window.SPU=e()});function n(e,n,i,o,r){var s={url:spuvar.ajax_url,data:e,cache:!1,type:"POST",dataType:"json",timeout:3e4};r=r||!1,i=i||!1,o=o||!1;n&&(s.url=n),i&&(s.success=i),o&&(s.error=o),r&&(s.dataType=r),t.ajax(s)}var i=!1,o=setInterval(function(){"undefined"==typeof FB||i||function(){try{FB.Event.subscribe("edge.create",function(e,n){var i=t(n).parents(".spu-box").data("box-id");i&&SPU.hide(i,!1,!0)})}catch(t){}i=!0,clearInterval(o)}()},1e3);if("undefined"!=typeof twttr)try{twttr.ready(function(t){t.events.bind("tweet",r),t.events.bind("follow",r)})}catch(t){}function r(e){var n=t(e.target).parents(".spu-box").data("box-id");n&&SPU.hide(n,!1,!0)}}(jQuery);